(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/certification"],{"3c53":function(t,e,n){"use strict";n.r(e);var a=n("ceb4"),r=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,function(){return a[t]})}(o);e["default"]=r.a},"4b03":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},r=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return r})},"509c":function(t,e,n){"use strict";(function(t){n("8602"),n("921b");a(n("66fd"));var e=a(n("d88c"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},"6a7f":function(t,e,n){},"71cc":function(t,e,n){"use strict";var a=n("6a7f"),r=n.n(a);r.a},"7d0a":function(t,e,n){},"9b28":function(t,e,n){"use strict";var a=n("7d0a"),r=n.n(a);r.a},ceb4:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=c(n("a34a")),r=n("d441"),o=n("2f62"),u=c(n("ee6a"));function c(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n,a,r,o,u){try{var c=t[o](u),i=c.value}catch(s){return void n(s)}c.done?e(i):Promise.resolve(i).then(a,r)}function s(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var o=t.apply(e,n);function u(t){i(o,a,r,u,c,"next",t)}function c(t){i(o,a,r,u,c,"throw",t)}u(void 0)})}}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){f(t,e,n[e])})}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=getApp(),h={name:"home",data:function(){return{submitData:{card_no:l.globalData.cardId,name:"",phone:"",sms_code:"",identity_no:""},authTimes:0,dataErrTip:{name:"姓名不能为空",sms_code:"验证码不能为空"},btnActive:!0,btnTimer:0,cntNum:59,hasErr:0}},computed:d({btnClass:function(){return{btn:!0,"btn-identify":this.btnActive,"btn-unable":!this.btnActive}}},(0,o.mapState)(["openID"])),mounted:function(){clearInterval(this.btnTimer),this.btnTimer=0,this.getCardInfo()},methods:d({setTimer:function(){var e=this;if(!/^1[3456789]\d{9}$/.test(e.submitData.phone))return t.showToast({title:"手机号格式不正确",icon:"none"}),1;t.request({url:u.default+"wx/send_sms_code",method:"POST",data:{phone_number:e.submitData.phone},success:function(n){t.showToast({title:"验证码发送成功",icon:"none"}),e.btnActive=!1,e.btnTimer=setInterval(e.cntNumDown,1e3)}})},cntNumDown:function(){this.cntNum>1?this.cntNum-=1:(this.cntNum=59,btnActive=!0,clearInterval(this.btnTimer),this.btnTimer=0)},toPostData:function(){var e=this;if(!/^\d{17}[\d,X,x]$/.test(e.submitData.identity_no))return t.showToast({title:"身份证号格式不正确",icon:"none"}),0;if(!/^1[3456789]\d{9}$/.test(e.submitData.phone))return t.showToast({title:"手机号格式不正确",icon:"none"}),1;for(var n in e.dataErrTip)if(""==e.submitData[n])return t.showToast({title:e.dataErrTip[n],icon:"none"}),3;e.authTimes>0?t.request({url:u.default+"wx/auth_pre_pay_app",method:"GET",data:{card_no:e.submitData.card_no},success:function(n){200!=n.statusCode&&0!=n.data.code||t.requestPayment({provider:"wxpay",orderInfo:n.data.result,success:function(t){e.postAuthData()}})}}):e.postAuthData()},postAuthData:function(){var e=this;t.request({url:u.default+"wx/identity_auth",method:"POST",data:e.submitData,success:function(n){0==n.data.code?t.showModal({title:"提示",content:n.data.msg,confirmText:"确定",showCancel:!1,complete:function(n){e.getCardInfo(),t.switchTab({url:"/pages/user"})}}):t.showModal({title:"提示",content:n.data.msg,confirmText:"确定",showCancel:!1,complete:function(e){t.navigateTo({url:"/pages/pre-certify"})}})}})},getCardInfo:function(){var t=s(a.default.mark(function t(){var e=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,r.getCheckCardByNumber)(this.submitData.card_no).then(function(t){200==t.statusCode&&""!=t.data.card_no&&(e.asyncSetting({ispName:t.data.operator,docUrl:t.data.use_doc_url,passwordExist:t.data.password_exist,needUnbind:t.data.need_unbind,supportRecover:t.data.support_recover,payMode:t.data.pay_mode,needAuth:t.data.need_auth,certStatus:t.data.cert_status,can_tg:t.data.can_tg,changeCard:t.data.change_card,cardChgStu:t.data.change_status}),e.authTimes=t.data.auth_times)});case 2:t.sent;case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},(0,o.mapActions)(["asyncSetting"])),components:{}};e.default=h}).call(this,n("6e42")["default"])},d88c:function(t,e,n){"use strict";n.r(e);var a=n("4b03"),r=n("3c53");for(var o in r)"default"!==o&&function(t){n.d(e,t,function(){return r[t]})}(o);n("71cc"),n("9b28");var u=n("2877"),c=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"41ad548c",null);e["default"]=c.exports}},[["509c","common/runtime","common/vendor"]]]);